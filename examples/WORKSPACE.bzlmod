#################################
# Dependencies for nccl example #
#################################
# NOTE: this should have been placed in MODULE.bazel, but use_repo_rule is introduced in Bazel 7.
# See https://github.com/bazelbuild/bazel/issues/17141

# http_archive = use_repo_rule("@bazel_tools//tools/build_defs/repo:http.bzl", "http_archive")  # For MODULE.bazel
load("@bazel_tools//tools/build_defs/repo:http.bzl", "http_archive")  # For WORKSPACE.bazel

http_archive(
    name = "nccl",
    build_file = "@rules_cuda_examples//nccl:nccl.BUILD",
    sha256 = "83b299cfc2dfe63887dadf3590b3ac2b8b2fd68ec5515b6878774eda39a697d2",
    strip_prefix = "nccl-9814c75eea18fc7374cde884592233b6b7dc055b",
    urls = ["https://github.com/nvidia/nccl/archive/9814c75eea18fc7374cde884592233b6b7dc055b.tar.gz"],
)

http_archive(
    name = "nccl-tests",
    build_file = "@rules_cuda_examples//nccl:nccl-tests.BUILD",
    patch_args = [
        "-p1",
    ],
    patches = ["@rules_cuda_examples//nccl:nccl-tests-clang.patch"],
    sha256 = "d589c597110da30b52d462269ae0d0381c46811a7b266db09fe865d9aaff31c1",
    strip_prefix = "nccl-tests-da0b547b1b9c6e3b1d4c15578087874522ae3761",
    urls = ["https://github.com/nvidia/nccl-tests/archive/da0b547b1b9c6e3b1d4c15578087874522ae3761.tar.gz"],
)
